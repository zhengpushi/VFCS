<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>FML4FCS - Introduction</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (https://tug.org/tex4ht/)"> 
<meta name="originator" content="TeX4ht (https://tug.org/tex4ht/)"> 
<!-- html --> 
<meta name="src" content="index.tex"> 
<link rel="stylesheet" type="text/css" href="index.css"> 
</head><body 
>
<script src="/FML4FCS/web-common/jquery-3.6.0.min.js"></script>
<div id="header"></div><script type="text/javascript">$("#header").load("/FML4FCS/web-common/header.html");</script>
<!--l. 57--><p class="noindent" >
                                                                                

                                                                                
<!--l. 57--><p class="indent" >
                                                                                

                                                                                
<div class="center" 
>
<!--l. 57--><p class="noindent" >
<!--l. 57--><p class="noindent" ><span 
class="cmr-17">Formal Method Library for Flight Control System in Coq</span>
<div class="tabular"> <table id="TBL-1" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-1-1g"><col 
id="TBL-1-1"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-1-1-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-1-1"  
class="td11"> <span 
class="cmr-12">Zhengpu Shi  </span></td>
</tr><tr 
class="vspace" style="font-size:10.00002pt"><td 
>&nbsp;</td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-2-1"  
class="td11">  <span 
class="cmr-12">Draft V1.0   </span></td></tr></table></div>
<!--l. 57--><p class="noindent" ><span 
class="cmr-12">Jan 01, 2021</span></div>
    <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-10001"></a>Intorduction</h3>
<!--l. 86--><p class="noindent" >Aircraft is a big category of products in the Safety Critical Areas, including aircraft, spacecraft, guided
weapons and so on. The aircraft can operate semi-autonomously or fully autonomously, and they all
need to be equipped with flight control software (FCS) to control their operations. FCS is
a highly complex software product with high reliability requirements. Although a lot of
manpower and material resources have been invested in the research and development of
FCS, flight faults caused by software errors often occur. Existing software development
methods cannot completely eliminate software defects, for at least three possible reasons.
First, software programming models derived from flight control theory may contain errors.
Because lots of manual derivation. Second, the process of converting the FCS model into FCS
program may have errors. Becuaes lots of manual coding. Third, traditional software testing
methods havn&#8217;t ability to prove that the software is free of defects. Because the ability of these
technologies is to find as many bugs as possible, they don&#8217;t make sure they find all the
bugs.
<!--l. 105--><p class="indent" >    In conclusion, under the existing development methods, we cannot completely avoid the design
defects in flight control software. We need to address these challenges and find better ways to develop
software. As an attempt, we introduce formal verification technology to try to develop flight
control software with high reliability. Formal method is an important method to improve
and ensure the quality of computing system. Its models, techniques and tools have been
developed into the important carrier of computing thinking. Formal methods include theorem
proving, model checking, abstract interpretation and other techniques. Among them, theorem
proving technology can be used for the verification of mathematical formulas and computer
algorithms, which is the most strict and powerful verification means. COQ is such an interactive
higher-order theorem prover, which is based on the basic theory of inductive construction
calculus, and has strong expressive ability and supports rich logic system. COQ can be used to
express specifications, construct program models that meet specifications, and perform formal
verification on programs that require high credibility. Although there are a lot of international
and domestic work on formal methods, there is very little work on formal verification of
control systems based on COQ, and the potential of this aspect has not been fully explored.
We believe that COQ will play an important role in the reliability verification of control
system.
<!--l. 119--><p class="indent" >    We choose the common multi-rotor UAV for research, because this system is small and scalable,
and contains the basic principle of the aircraft. We focus on the formal verification of the mathematical
                                                                                

                                                                                
theory and control model in the flight control system of multi-rotor UAV in COQ, and plan to establish
the COQ formal software library applied to flight control. In the future, we can use this formal software
library to design reliable flight control software. We named this library as FML4FCS (Formal Method
Library for Flight Control System). There are two things that need to be done: First, write precise and
unambiguous specifications which called formal specification. Second, prove things are correct which
called formal verification.
<!--l. 127--><p class="indent" >    We will gradually build FML4FCS (also known as model library, also known as formal method
library, also known as software library). According to the way of module division, each subsystem is
constructed separately from the function, which will be integrated into a complete system in the later
stage. And, at the beginning, we&#8217;ll simplify some of the issues, but the basic functionality and the basic
principle need to be preserved. For a specific system or module, we need to do the following
work:
        <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
    (1). </dt><dd 
class="enumerate-enumitem">Understand the engineering knowledge of the system and convert it into a reference
        manual  suitable  for  formal  verification  and  program  development.  Engineering
        knowledge includes concepts, units, symbols, relations, and derivation processes that
        appeared  in  flight  control  systems.  An  important  purpose  is  to  create  a  common
        workspace  among  domain  experts,  formal  verification  developers,  and  application
        developers.
        </dd><dt class="enumerate-enumitem">
    (2). </dt><dd 
class="enumerate-enumitem">Builds  the  software  model  in  COQ  according  to  this  reference  manual.  Divide  the
        different modules and hierarchies and build them step by step. We define each concept as
        a constant or a variable, the process of transformation between concepts as a function,
        and the derivation as a proposition. For example, the standard atmospheric pressure
        is a constant, and propeller speed is a variable, and calculating the propeller speed by
        motor rotate spped is a function, and it is a proposition that battery voltage equals
        battery input current times battery internal resistance.
        </dd><dt class="enumerate-enumitem">
    (3). </dt><dd 
class="enumerate-enumitem">Provides basic software libraries that we need but are missing from the COQ library.
        Since some mathematical theories and physical theories have not been established in
        the COQ database, we need to provide it.
        </dd><dt class="enumerate-enumitem">
    (4). </dt><dd 
class="enumerate-enumitem">Proves that all propositions in the software model we&#8217;ve just built are true.</dd></dl>
<!--l. 146--><p class="indent" >    It should be noted that, since this is an interdisciplinary research work and the flight control
theory is highly professional, the formula derivation may not be able to be proved when proving
propositions. At this point, we should go back and review the flight control literature and revise the
definitions. This process may require several iterations, as shown in the figure below. This process
embodies the advantages of formal techniques, because formal methods can ensure a high degree of
consistency throughout the process.
<!--l. 151--><p class="indent" >    <hr class="figure"><div class="figure" 
>
                                                                                

                                                                                
<a 
 id="x1-1005r1"></a>
                                                                                

                                                                                
<!--l. 153--><p class="noindent" > <img 
src="figures/knowledge_definition_proof-.png" alt="PIC"  
width="800" >
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;1: </span><span  
class="content">A recursive procedure</span></div><!--tex4ht:label?: x1-1005r1 -->
                                                                                

                                                                                
<!--l. 156--><p class="indent" >    </div><hr class="endfigure">
    <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-20002"></a>FML4FCS - Formal Method Library For Flight Control System in Coq</h3>
<!--l. 160--><p class="noindent" >
    <h5 class="subsubsectionHead"><span class="titlemark">2.0.1   </span> <a 
 id="x1-30002.0.1"></a>What is the FML4FCS</h5>
<!--l. 161--><p class="noindent" >It is an Formal Verification Library for Flight Control System (FML4FCS) developed under the COQ.
The Flight Control System (FCS) requires professional engineering knowledge in aerodynamics,
electronmagnetism and mechanics, etc. The algorithms in flight control are actually derived by using
these knowledge or theories under many assumptions, and need lots of derivations. We
are not concerned with the correctness of these theories, but with the correctness of their
derivation.
<!--l. 166--><p class="indent" >    We made a simple division of the various types of people involved in the design of the flight control
system. (1) Domain Experts (ROLE - DE). The correctness of the theory should be left to the relevant
experts. (2) Formal Method Proof Engineer (ROLE - FMPE). The derivation is left to the formal
method proof engineer. (3) Computer Programmer (ROLE - CP). What programmers need is a reliable
software repository that they can use.
<!--l. 171--><p class="indent" >    This document is useful for all three types of people, but mainly for formal method proof
engineers.
<!--l. 173--><p class="noindent" >
    <h5 class="subsubsectionHead"><span class="titlemark">2.0.2   </span> <a 
 id="x1-40002.0.2"></a>How is the library organized</h5>
<!--l. 174--><p class="noindent" >This library is being built gradually, and organized by seperated sub-system at first stage.
<!--l. 176--><p class="indent" >    For each subsystem, we follow the following steps:
        <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
    (1). </dt><dd 
class="enumerate-enumitem">Understand  the  engineering  knowledge  of  the  system  and  translate  it  into  a
        mathematical document that suitable for formal verification. Currently we only provide
        the  English  version  mathematical  document,  other  language  versions  need  extra
        translation work.
        </dd><dt class="enumerate-enumitem">
    (2). </dt><dd 
class="enumerate-enumitem">Converts the mathematical document to COQ code and completes the proof of the
        lemma.
        </dd><dt class="enumerate-enumitem">
    (3). </dt><dd 
class="enumerate-enumitem">Use COQ&#8217;s program extraction function to obtain reliable OCaml language library.
        </dd><dt class="enumerate-enumitem">
    (4). </dt><dd 
class="enumerate-enumitem">Presents some concrete sample programs so that users can observe and work with these
        work.</dd></dl>
<!--l. 189--><p class="noindent" >
    <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-50003"></a>Sub systems of FCS</h3>
<!--l. 191--><p class="noindent" >The research object is flight control system of multicopter, especially an electric multi-rotor drone. We
started with subsystems tt the beginning.
                                                                                

                                                                                
<!--l. 194--><p class="noindent" >
    <h4 class="subsectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-60003.1"></a>Propulsion System</h4>
<!--l. 195--><p class="noindent" >Propulsion system consists of four components: propeller, motor, electronic speed controller (ESC) and
battery. We modeled each of the components.
<!--l. 198--><p class="indent" >    The main purpose of this section is to solve two kinds of problems, the forward solution and the
reverse solution.
<!--l. 200--><p class="indent" >    Forward solution refers to the estimation of performance indicators such as the longest hovering
time, maximum load weight and maximum pitch angle of the aircraft when the parameters of each
component are known.
<!--l. 202--><p class="indent" >    Reverse solution refers to the design of the best parameters of each component under the required
performance indicators.
<!--l. 204--><p class="indent" >    We focus on the relatively simple forward issues, and the subsequent program will deal with the
reverse issues.
<!--l. 206--><p class="noindent" >
    <h4 class="subsectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-70003.2"></a>AttitudeSystem</h4>
<!--l. 208--><p class="noindent" >This part adds new mathematical theories, such as vectors, matrices, quaternions, etc. Vectors and
matrices are not available in COQ, we present an implementation. We give an implementation of
vectors, including the definitions of various operations and their properties. The operations of vector,
including addition, negative vector, subtraction, dot product, cross product, etc.
<!--l. 213--><p class="indent" >    We define a matrix as a vector of a vector, and give the operations related to matrix and the
transformation between vector and matrix, and give the proof of the properties of common
operations.
<!--l. 215--><p class="indent" >    Quaternions also have no library available in COQ, and we present several different
implementations. We have verified the multiplication formula of quaternions. In addition, the
quaternion is able to represent the rotation of the vector, and we have also tried to prove this
theorem. There are mainly three different methods of attitude representation, including
Euler Angle, rotation matrix and quaternion. Each of these three methods has its own
advantages and disadvantages. Euler Angle is intuitive but has singularity; rotation matrix has no
singularity but requires a large amount of computation when solving differential equations;
although quaternions are not intuitive, they are not singularity and have little computation.
Therefore, we will use these different methods interchangeably and need to convert between
them. We give the definitions of these transformation processes and attempt to give some
proofs.
<!--l. 227--><p class="noindent" >
    <h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-80004"></a>The full system</h3>
<!--l. 233--><p class="noindent" >
    <h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x1-90005"></a>Summary</h3>
<!--l. 234--><p class="noindent" >I think we&#8217;ve done the following: 1. Convert complex textual expertise in the field of flight
control into a bottom-up verification and programming oriented reference manual. It has
built a unified dialogue bridge between field experts, verification engineers and software
engineers, shielding the knowledge differences between people of different identities. 2. We have
                                                                                

                                                                                
developed a working model. The domain expert only need to cares about the correctness of the
presentation of the reference manual, and does not need to care about the correctness of the
derivation and programming. The verification engineer only needs to establish the build
and verify the model and ensure the correct derivation according to the manual, and does
not need to care about the theory and how to program; Software engineers only need to
use the manual to program, do not need to care about the theory and the correctness of
these methods. 3. We have completed the formal verification of most subsystems in flight
control.
<!--l. 243--><p class="indent" >    In addition, our research method and part of the research results can also be used in other
engineering fields. Reliability is still the core task of future flight control system development. In
addition, with the increase of system scale, development efficiency becomes more and more important.
Our goal is to design a development platform that automatically generates reliable software code for
flight control applications. This is done by first formalizing the system model, then configuring the
system in a building block-like way, and finally using code generation tools to automatically generate
the software. Thus, we can ensure the reliability of the software, and improve the efficiency of software
development.
<!--l. 251--><p class="noindent" >
    <h3 class="likesectionHead"><a 
 id="x1-100005"></a>References</h3>
<!--l. 251--><p class="noindent" >
    <div class="thebibliography">
    <p class="bibitem" ><span class="biblabel">
  [1]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xqq"></a>Quan Q. Introduction to multicopter design and control. Springer, 2017.</p></div>
     
<div id="footer"></div><script type="text/javascript">$("#footer").load("/FML4FCS/web-common/footer.html");</script>
</body></html> 

                                                                                


