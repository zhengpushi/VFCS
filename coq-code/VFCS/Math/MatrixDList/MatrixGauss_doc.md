
# Document for MatrixGauss（高斯消元）

## 一些想法
1. 定义高斯消元方法；
2. 对线性方程组的增广矩阵化简为阶梯形矩阵，可判断解的情形，也可自底向上解方程组；
   若最后一列不为0，则无解；
   除去最后一列，若剩下的不是方阵，或者有全零行，则有无穷多解，反之有唯一解。
3. 或者直接化简为行最简阶梯形，可直接得到解。
4. 在变换过程中的初等变换阵收集起来后就是逆矩阵。
5. 进一步可实现LU分解，从而快速解方程组。
   因为由 Ax=b 解方程的时间复杂度是 n^2
   若得到 A=LU，则 LUx=b，先由 Ly=b 解出 b，再由 Ux=y 解出 x，这样时间复杂度是
   (1/3) n^2。
6. 进一步，可实现奇异值分解，但需要解特征值和特征向量。
   这又涉及到行列式、分块矩阵的行列式(为了简化计算)。
   在计算特征值时的一个问题是，求解一元多项式（我尚未仔细研究这个问题）
7. 矩阵方程 Ax=b，还有更一般的 Ax=B 的形式，例如 《线性代数》同济5版,p65,例3。

## 高斯消元的用途
### 1. 求逆矩阵
* 输入：方阵。输出：无逆矩阵，或给出一个逆矩阵
* 有两种做法：
  * (A|E) = (E|B)，如果得到了这种形式，则B是A的逆。
	这种方式需要拼接一个额外的矩阵做高斯消元。
  * $P_n \ldots P_2 P_1 A = E$，则 $P=P_n \ldots P_2 P_1$就是A的逆。
	这种方式需要记住做过的变换。又有两种做法：
	a) 每次做矩阵乘法来直接得到结果。
	b) 用抽象表示记住动作，最后再合成。
	注意，如果中途发现了阶梯形异常，则可判定无逆矩阵。
### 2. 解线性方程组
* 输入：增广矩阵。输出：无解，唯一解，无穷多解
* 方程的解有三种情形：
  * 无解：当出现以下情形时。
	$$
	\begin{bmatrix}
	1 & 0 & 0 & a\\
	0 & 1 & 0 & b\\
	0 & 0 & 0 & c\\
	\end{bmatrix}
	$$
  * 有唯一解：当出现以下的标准形式时
	$$
	\begin{bmatrix}
	1 & 0 & 0 & a\\
	0 & 1 & 0 & b\\
	0 & 0 & 1 & c\\
	\end{bmatrix}
	$$
	特点是：行的秩 rank_row(A) = columns - 1。
	此时，解是 
	$$
	\begin{bmatrix}x\\y\\z\end{bmatrix} = 
	\begin{bmatrix}a\\b\\c\end{bmatrix}
	$$
  * 有无穷多解：当出现以下情形时
	$$
	\begin{bmatrix}
	1 & 0 & a & c\\
	0 & 1 & b & d\\
	0 & 0 & 0 & 0\\
	\end{bmatrix}
	$$
	特点是：行的秩 rank_row(A) < columns - 1
	此时，有一个自由变量，可以选为z，或新的 $k_1$。解是 
	$$
	\begin{bmatrix}x\\y\\z\end{bmatrix} = 
	k_1\begin{bmatrix}-a\\-b\\1\end{bmatrix} +
	\begin{bmatrix}c\\d\\0\end{bmatrix}
	$$
  * 有无穷多解时，有两个自由变量的例子。例如以下情形
	$$
	\begin{bmatrix}
	1 & 0 & a & c & e\\
	0 & 1 & b & d & f\\
	0 & 0 & 0 & 0 & 0\\
	\end{bmatrix}
	$$
	此时，选择两个自由变量 $k_1,k_2$，解是
	$$
	\begin{bmatrix}x\\y\\z\\w\end{bmatrix} = 
	k_1\begin{bmatrix}-a\\-b\\1\\0\end{bmatrix} +
	k_2\begin{bmatrix}-c\\-d\\0\\1\end{bmatrix} +
	\begin{bmatrix}e\\f\\0\\0\end{bmatrix}
	$$
	或者写成如下的向量形式
	$$
	\begin{bmatrix}x\\y\end{bmatrix} = 
	\begin{bmatrix}-a&-c\\-b&-d\end{bmatrix} 
	\begin{bmatrix}k_1\\k_2\end{bmatrix} +
	\begin{bmatrix}e\\f\end{bmatrix},\qquad
	\begin{bmatrix}z\\w\end{bmatrix} =
	\begin{bmatrix}k_1\\k_2\end{bmatrix}
	$$
  * 从以上的例子能看到一些规律。但是实际工程问题中，如何表达这种含自由变量的结果？需要再了解。

## 高斯消元算法：化为阶梯形矩阵
* 介绍
  这一步完成后已经能够自底向上的解方程了，但还不够完美。
* 算法设计
  1. i=0,j=0
  2. 如果 i>=r 或 j>=c，则结束。
  3. 从第j列第i行开始向下查找，第一个不为0的元就是主元 pivot，该行记为 i'
  4. 若找不到，则 i 不变，j++，进入 [2]
  5. 若i和i'不相等，则做一次交换（之后就忘记 i')
  6. 将第i行以下的每一行进行 KAdd 变换，row(k) -= A(k,j)/A(i,j) * row(i)
	 这样将使得第j列的第i行以下都成为0。
  7. i++,j++, 进入 [2]
  

## 高斯消元算法：由阶梯形矩阵再化为行最简阶梯形矩阵
* 给定一般情形如下
  $$
  \begin{bmatrix}
  a & x & x & x & x\\
  0 & 0 & b & x & x\\
  0 & 0 & 0 & c & x\\
  0 & 0 & 0 & 0 & 0\\
  \end{bmatrix}
  $$
  其中，a,b,c表示非零元，而x表示任意。
  特点是：
  1. 可能有全零行，但一定在最下方。
  2. 可能阶梯的横向步长不是严格的1，但纵向步长一定都是1。
* 算法思路
  自底向上的递归执行。
  若是全零行，则不处理；否则不是全零行，做如下处理。
  首先将主元处理为1，可以用 rowK 来处理；然后处理主元右侧的其余元。
  若右侧的元对应的这一列有主元，则使用主元那一行来消去。
* 算法设计
  1. 用到的变量
	 (1) 行号 i。这是递归的主参数。初始为 r，由 i = S i' 可分解出 i' 来操作第 i' 行的数据。
	 (2) 主元位置表 pivots : list (colID * rowID)。
		保存了主元的列号与行号。
		初始为空，每处理一个行，则可能向 pivots 加入一条记录。
  2. 若 i =? 0，则结束
  3. 若第i行全为0，则进入 [5]；否则进入 [4]。
  4. 找出第i行的第一个非零元 A(i,j)，这就是该行的主元。顺序执行以下任务：
	 (1) 向主元位置表写入这个位置。
	 (2) 若该主元不是1，则做变换：(i) = (i) * 1/A(i,j)。
	 (3) 对于主元右侧的所有元A(i,j'), $j'\in[S j, c)$，依次执行以下任务。
		(a) 检查 A(i,j') 是否为0，若是0，则进入[5]，否则继续
		(b) 检索主元位置表中是否有第k列的主元，若找不到则进入[5]，否则继续
		(c) 找到主元位置是(i',j')，则做变换：(i) = (i) - (i') * A(i,j')；
  5. i--，进入 [2]

## 高斯消元法求逆矩阵
* 介绍
  已有两个算法，rowEchelon 和 minRowEchelon，分别计算了行阶梯形和行最简阶梯形矩阵。
  将这两个算法串联可以实现逆矩阵。
* 算法设计
